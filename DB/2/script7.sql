SELECT count(DISTINCT Н_УЧЕНИКИ.ЧЛВК_ИД)
FROM Н_УЧЕНИКИ
JOIN Н_ВЕДОМОСТИ ON Н_ВЕДОМОСТИ.ЧЛВК_ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
WHERE Н_ВЕДОМОСТИ.ОЦЕНКА = (SELECT КОД FROM Н_ОЦЕНКИ WHERE ПРИМЕЧАНИЕ = 'диплом с отличием')
AND Н_УЧЕНИКИ.ПЛАН_ИД IN (SELECT ИД
                  FROM Н_ПЛАНЫ
                  WHERE ОТД_ИД = (SELECT ИД
                                  FROM Н_ОТДЕЛЫ
                                  WHERE КОРОТКОЕ_ИМЯ = 'КТиУ'));